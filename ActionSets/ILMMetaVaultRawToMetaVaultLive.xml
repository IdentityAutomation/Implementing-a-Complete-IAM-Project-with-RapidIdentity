<actionDefs xmlns="urn:idauto.net:dss:actiondef">
  <actionDef changeCount="593" modifiedMs="1568916771253" modifiedBy="ed6d4420-44e9-4232-9988-039609164f8b" modifiedByName="admin" name="ILMMetaVaultRawToMetaVaultLive" category="" builtIn="false" community="false">
    <argDefs>
      <argDef optional="true" type="enum:all,employees,students,professors,customers" name="affiliation"/>
    </argDefs>
    <actions>
      <action id="04EF04D8-089F-3E76-8045-20D24D92F923" name="openDatabaseConnection" outputVar="sessionMV">
        <arg name="jdbcDriverClass" value="&quot;com.mysql.cj.jdbc.Driver&quot;"/>
        <arg name="jdbcURL" value="&quot;jdbc:mysql://10.0.8.160/metavault&quot;"/>
        <arg name="user" value="&quot;idautoAdmin&quot;"/>
        <arg name="password" value="$$$pwd(&quot;Lx29KhhL2eYpyOXnN7c3f//BUGcSBaLroChKhsD2nM0=&quot;)"/>
      </action>
      <action id="86CD4198-E8E5-6900-8B4D-2B8195E8A953" name="section">
        <arg name="label" value="DiscoverAffiliations"/>
        <arg name="do">
          <action id="BD2A8C0B-D1E6-44B3-708A-2B8195E9D3E3" name="setVariable">
            <arg name="name" value="affiliations"/>
            <arg name="value" value="[]"/>
          </action>
          <action id="5EAAAD2B-85FC-C52A-8B57-2B8195E9DEE4" name="if">
            <arg name="condition" value="affiliation &amp;&amp; affiliation != 'all'"/>
            <arg name="then">
              <action id="F3528009-4992-668D-2365-2B8195EAF0F9" name="appendArrayItem">
                <arg name="array" value="affiliations"/>
                <arg name="item" value="affiliation"/>
              </action>
              <action id="61124524-D52B-3580-C46A-2B8195EB275E" name="break">
                <arg name="label" value="DiscoverAffiliations"/>
              </action>
            </arg>
          </action>
          <action id="68EA4AA7-79A3-201F-F026-2B8195EC024D" name="setVariable">
            <arg name="name" value="sql"/>
            <arg name="value" value="&quot;SELECT affiliation FROM ingest_raw GROUP BY affiliation&quot;"/>
          </action>
          <action id="4D9775C5-695A-6B21-3A89-2B8195EDBC09" name="queryDatabaseSQL" outputVar="records">
            <arg name="dbConnection" value="sessionMV"/>
            <arg name="sql" value="sql"/>
          </action>
          <action id="17839330-AD93-DF3D-DE2B-2B8195EE6A02" name="forEach">
            <arg name="variable" value="record"/>
            <arg name="collection" value="records"/>
            <arg name="do">
              <action id="AFA17AC7-BED0-B434-714A-2B8195EFE00F" name="appendArrayItem">
                <arg name="array" value="affiliations"/>
                <arg name="item" value="record.affiliation"/>
              </action>
            </arg>
          </action>
        </arg>
      </action>
      <action id="8AEB332A-EE17-8138-F583-3B92FC4359E6" name="section">
        <arg name="label" value="IterateAffiliations"/>
        <arg name="do">
          <action id="3C7C3697-E1AA-DCD2-1BC1-3B931A885840" name="forEach">
            <arg name="variable" value="affiliation"/>
            <arg name="collection" value="affiliations"/>
            <arg name="do">
              <action id="937570E9-C40B-4B4A-3A13-3B20EBEECB28" name="section">
                <arg name="label" value="Step1"/>
                <arg name="do">
                  <action id="CD1CF2C8-A84F-103A-4189-3B21A1A2A25B" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step01_FlagNotInMaster.sql&quot;"/>
                  </action>
                  <action id="F228CD5F-6D76-97B5-D137-3B217B2169B4" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="015B71A0-6ED7-66C0-A2DC-3B20EBF48108" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="15AAF017-6EFB-A7D6-C913-3B20EBF66FCD" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step1 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="6759952C-2D2F-93B1-3205-3B2390337BDA" name="section">
                <arg name="label" value="Step2"/>
                <arg name="do">
                  <action id="F44E5EAB-4FC8-DEFA-2061-3B2390366641" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step02_InsertIntoMaster.sql&quot;"/>
                  </action>
                  <action id="F0CEBC12-1333-763E-7D2D-3B23903818BF" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="78B697F7-C03B-CACD-5BB7-3B23903E9BDA" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="58A73178-0A12-D33C-D0F0-3B23903FCD7D" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step2 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="93285ADD-C817-12EF-45AD-4A3E30167B75" name="section">
                <arg name="label" value="Step3"/>
                <arg name="do">
                  <action id="0BB26381-BE5B-F2A1-2F62-4A3E3017792D" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step03_FlagAffiliationNotInMaster.sql&quot;"/>
                  </action>
                  <action id="BF7D7400-334C-B271-8673-4A3E301DA02D" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="EF1F2851-CF74-08A8-56E1-4A3E301E68EB" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="0A9DB185-5757-7213-47A0-4A3E301F4EBD" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step3 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="8668557E-35C4-9BAC-B54B-4A3FA516B6C0" name="section">
                <arg name="label" value="Step4"/>
                <arg name="do">
                  <action id="F392C928-DBE4-73B1-E78E-4A3FA523873B" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step04_UpdateAffiliationInMaster.sql&quot;"/>
                  </action>
                  <action id="CE04EE4B-5BF0-EA21-F503-4A3FA525F289" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="A2504267-9442-23F7-4A78-4A3FA5265F48" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="FB59879E-864C-EE16-6D81-4A3FA527DBFE" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step4 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="EEC3CBFD-6B6E-3710-098F-3B241C893573" name="section">
                <arg name="label" value="Step5"/>
                <arg name="do">
                  <action id="A75045BE-B287-BFF7-348C-3B241C8B9870" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step05_FlagNotInLive.sql&quot;"/>
                  </action>
                  <action id="FB9C200D-8B7C-85EC-26C7-3B241C8C3859" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="0289130C-5954-EDA5-FF0C-3B241C9268D9" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="5DDFBD81-509F-941A-929A-3B241C945FDE" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step5 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="F60AEF97-FC16-ED46-6CFA-3B248768D87D" name="section">
                <arg name="label" value="Step6"/>
                <arg name="do">
                  <action id="5A3092C8-5F10-658D-644E-3B24876AF873" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step06_InsertIntoLive.sql&quot;"/>
                  </action>
                  <action id="82E9E4C0-8BBD-8055-AAC8-3B24876BA877" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="A770AC6B-BB65-2E7B-3DD9-3B24876C1F91" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="B177CB28-72A7-225A-6D53-3B24876DC298" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step6 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="A755DEEE-1B32-7511-A5BA-3B2519171623" name="section">
                <arg name="label" value="Step7"/>
                <arg name="do">
                  <action id="19618372-3F43-E7B2-514B-3B251918D4EC" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step07_InsertAddsIntoEventLog.sql&quot;"/>
                  </action>
                  <action id="29DB722B-C9F3-1803-7710-3B25191AF583" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="DDFA6229-4335-1DB7-98EC-3B25191BF24F" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="C5C9B148-3F34-8B37-5650-3B25191C2FCB" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step7 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="FE2AF2AA-E2E9-1EE8-0385-3B258C564BC2" name="section">
                <arg name="label" value="Step8"/>
                <arg name="do">
                  <action id="00CA4D59-4D85-0339-D2BF-3B258C58CD84" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step08_FlagDeltasInLive.sql&quot;"/>
                  </action>
                  <action id="E14A7B3F-6A46-2D14-59E4-3B258C595F5A" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="EB610125-C3D7-226B-4505-3B258C5FC555" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="60060A55-679F-FA9D-8DD3-3B258C61955E" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step8 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="956A87B4-48FD-079B-C5E0-3B25FC76A676" name="section">
                <arg name="label" value="Step9"/>
                <arg name="do">
                  <action id="21A46526-27DB-1C5A-43E1-3B25FC786EEC" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step09_UpdateInLive.sql&quot;"/>
                  </action>
                  <action id="10882A40-24BD-3C64-9BBD-3B25FC79CD3E" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="DE0C3AF3-706F-525C-AB36-3B25FC7A7A22" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="F7C86EAD-EDAD-DE12-5467-3B25FC7BE4AD" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step9 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
              <action id="3C71E5E4-47DE-D90B-9789-3B266D8A58FF" name="section">
                <arg name="label" value="Step10"/>
                <arg name="do">
                  <action id="EBAC2815-D8F0-E83F-F87C-3B266D8C2A03" name="loadFileAsString" outputVar="sql">
                    <arg name="path" value="&quot;/sql/sync_step10_InsertUpdatesIntoEventLog.sql&quot;"/>
                  </action>
                  <action id="D6BBE8CA-6D07-BEFC-337D-3B266D8D7013" name="stringFromTemplate" outputVar="sql">
                    <arg name="format" value="sql"/>
                    <arg name="args" value="{affiliation: affiliation}"/>
                  </action>
                  <action id="523EF036-3667-A0A2-E98D-3B266D8E291E" name="updateDatabaseSQL" outputVar="results">
                    <arg name="dbConnection" value="sessionMV"/>
                    <arg name="sql" value="sql"/>
                  </action>
                  <action id="7D38DD75-CF3E-A407-6BB1-3B266D8FA351" name="log">
                    <arg name="message" value="results + &quot; &quot; + affiliation + &quot; sync step10 affected.&quot;"/>
                    <arg name="color" value="&quot;green&quot;"/>
                  </action>
                </arg>
              </action>
            </arg>
          </action>
        </arg>
      </action>
    </actions>
  </actionDef>
</actionDefs>